<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SmartPath AI - –¢–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä –æ–±—É—á–µ–Ω–∏—è</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root { --primary: #4A90E2; --bg: #f4f7f9; --text: #333; }
body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; margin: 0; padding: 20px; }
.container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
h1 { text-align: center; color: var(--primary); font-size: 24px; }
.question { margin-bottom: 20px; padding: 15px; background: #fafafa; border-radius: 10px; }
.options { display: grid; gap: 10px; margin-top: 10px; }
button { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 16px; width: 100%; font-weight: 600; margin-top: 10px; }
button:disabled { background: #ccc; cursor: not-allowed; }
.ai-output { background: #f0f7ff; border-left: 5px solid var(--primary); padding: 15px; margin-top: 20px; white-space: pre-wrap; font-size: 15px; }
#errorBox { color: red; background: #ffe6e6; padding: 15px; border-radius: 8px; margin-top: 20px; display: none; border: 1px solid red; }
#loading { display: none; text-align: center; color: var(--primary); font-weight: bold; margin: 20px 0; }
</style>
</head>
<body>

<div class="container">
<h1>üöÄ SmartPath AI</h1>

<form id="quizForm">
<div class="question">
<p><strong>1. –ö–∞–∫ —Ç—ã –ª—É—á—à–µ —Ä–∞–∑–±–µ—Ä–µ—à—å—Å—è –≤ –Ω–æ–≤–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ?</strong></p>
<div class="options">
<label><input type="radio" name="q1" value="–í–∏–∑—É–∞–ª" required> –†–∞—Å—Å–º–æ—Ç—Ä—é —Å–∫—Ä–∏–Ω—à–æ—Ç—ã</label>
<label><input type="radio" name="q1" value="–ê—É–¥–∏–∞–ª"> –ü–æ—Å–ª—É—à–∞—é –≤–∏–¥–µ–æ–æ–±–∑–æ—Ä</label>
<label><input type="radio" name="q1" value="–ü—Ä–∞–∫—Ç–∏–∫"> –ë—É–¥—É —Ç—ã–∫–∞—Ç—å –≤–æ –≤—Å–µ –∫–Ω–æ–ø–∫–∏</label>
</div>
</div>

<div class="question">
<p><strong>2. –ö–∞–∫ —Ç—ã –∏—â–µ—à—å –¥–æ—Ä–æ–≥—É –≤ –Ω–µ–∑–Ω–∞–∫–æ–º–æ–º –º–µ—Å—Ç–µ?</strong></p>
<div class="options">
<label><input type="radio" name="q2" value="–ö–∞—Ä—Ç–∞" required> –ü–æ—Å–º–æ—Ç—Ä—é –Ω–∞ –∫–∞—Ä—Ç—É</label>
<label><input type="radio" name="q2" value="–†–∞—Å—Å–ø—Ä–æ—Å"> –°–ø—Ä–æ—à—É —É –ª—é–¥–µ–π</label>
<label><input type="radio" name="q2" value="–ò–Ω—Ç—É–∏—Ü–∏—è"> –ü–æ–π–¥—É –Ω–∞—É–≥–∞–¥</label>
</div>
</div>

<button type="button" id="submitBtn" onclick="runAI()">–ü–æ–ª—É—á–∏—Ç—å –ø–ª–∞–Ω –æ—Ç –ò–ò</button>
</form>

<div id="loading">ü§ñ –ò–ò –¥—É–º–∞–µ—Ç... –ü–æ–¥–æ–∂–¥–∏ —Å–µ–∫—É–Ω–¥ 10.</div>
<div id="errorBox"></div>

<div id="resultArea" style="display:none;">
<h2>‚ú® –¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h2>
<div id="aiResponse" class="ai-output"></div>
<button onclick="window.location.reload()" style="background: #666; margin-top: 20px;">–ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</button>
</div>
</div>

<script>
async function runAI() {
    const form = document.getElementById('quizForm');
    const loading = document.getElementById('loading');
    const errorBox = document.getElementById('errorBox');
    const resultArea = document.getElementById('resultArea');
    const aiResponse = document.getElementById('aiResponse');

    const formData = new FormData(form);
    const results = Object.fromEntries(formData.entries());

    if (Object.keys(results).length < 2) {
        alert("–û—Ç–≤–µ—Ç—å –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã!");
        return;
    }

    form.style.display = 'none';
    loading.style.display = 'block';
    errorBox.style.display = 'none';

    const prompt = "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –æ—Ç–≤–µ—Ç—ã —Ç–µ—Å—Ç–∞: " + JSON.stringify(results) + ". –î–∞–π –∫—Ä–∞—Ç–∫–∏–π —Å–æ–≤–µ—Ç –ø–æ –æ–±—É—á–µ–Ω–∏—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.";

    try {
        const response = await fetch("https://test1-nzgy.onrender.com", { // –≤—Å—Ç–∞–≤—å —Å–≤–æ–π backend URL
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                contents: [{ parts: [{ text: prompt }] }]
            })
        });

        const data = await response.json();

        // ‚úÖ –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å undefined
        let text = "";
        if (data.candidates && data.candidates.length > 0) {
            text = data.candidates[0].content.parts[0].text;
        } else if (data.error) {
            throw new Error(data.error.message || "–û—à–∏–±–∫–∞ API");
        } else {
            throw new Error("–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞");
        }

        aiResponse.innerHTML = text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
        loading.style.display = 'none';
        resultArea.style.display = 'block';

    } catch (e) {
        loading.style.display = 'none';
        errorBox.style.display = 'block';
        errorBox.innerHTML = "<b>–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞:</b><br>" + e.message + "<br><br>–ü—Ä–æ–≤–µ—Ä—å –∫–ª—é—á –∏–ª–∏ –≤–∫–ª—é—á–∏ VPN.";
        form.style.display = 'block';
    }
}
</script>

</body>
</html>
